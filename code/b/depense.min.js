function getAllDepensesList(){var e=$.Deferred();return getListByTitleItems("DÃ©penses",_spPageContextInfo.webAbsoluteUrl,"","Date, Montant, Year, GestionnairesChoice","",function(n){return depensesList=n.d.results,console.log(depensesList),0===depensesList.length?void console.log("No Depense in Depenses's App"):void e.resolve()},errorHandler),e.promise()}function getAllDepensesDocLib(){var e=$.Deferred();return getListByTitleItems("Depenses",_spPageContextInfo.webAbsoluteUrl,"","Title, Prix, GestionnairesChoice","",function(n){return depensesDocLib=n.d.results,console.log(depensesDocLib),0===depensesDocLib.length?void console.log("No Depense in Depenses's App"):void e.resolve()},errorHandler),e.promise()}function getAllRemboursement(){var e=$.Deferred();return getListByTitleItems("Remboursement",_spPageContextInfo.webAbsoluteUrl,"","Title, Montant, GestionnairesChoice","",function(n){return remboursementArray=n.d.results,console.log(remboursementArray),0===remboursementArray.length?void console.log("No remboursement in remboursement's App"):void e.resolve()},errorHandler),e.promise()}function getAllManager(){var e=$.Deferred();return getListByTitleItems("Gestionnaires","https://mm3mm3.sharepoint.com/sites/immoDMMM","","id, Title, FirstName","",function(n){return managerArray=n.d.results,console.log(managerArray),0===managerArray.length?void console.log("No Manager in Manager's App"):void e.resolve()},errorHandler),e.promise()}function calcultateDepense(){var e=depensesList.filter(function(e){return"Merlin Martel"==e.GestionnairesChoice});$.each(e,function(e,n){depenseListMerlinTotal+=n.Montant}),console.log("Depense List Merlin en $ : "+depenseListMerlinTotal);var n=depensesList.filter(function(e){return"Denise Martel"==e.GestionnairesChoice});$.each(n,function(e,n){depenseListDeniseTotal+=n.Montant}),console.log("Depense List Denise en $ : "+depenseListDeniseTotal);var s=depensesDocLib.filter(function(e){return"Merlin Martel"==e.GestionnairesChoice});$.each(s,function(e,n){depenseDocLibMerlinTotal+=n.Prix}),console.log("Depense DocLib Merlin en $ : "+depenseDocLibMerlinTotal);var t=depensesDocLib.filter(function(e){return"Denise Martel"==e.GestionnairesChoice});$.each(t,function(e,n){depenseDocLibDeniseTotal+=n.Prix}),console.log("Depense DocLib Denise en $ : "+depenseDocLibDeniseTotal),$.each(depensesList,function(e,n){depensesListTotal+=n.Montant}),console.log(depensesListTotal),$.each(depensesDocLib,function(e,n){depensesDocLibTotal+=n.Prix}),console.log(depensesDocLibTotal)}function calculateRemboursement(){var e=remboursementArray.filter(function(e){return"Merlin Martel"==e.GestionnairesChoice});$.each(e,function(e,n){remboursementMerlinTotal+=n.Montant}),console.log("Remboursement Merlin total : "+remboursementMerlinTotal);var n=remboursementArray.filter(function(e){return"Denise Martel"==e.GestionnairesChoice});$.each(n,function(e,n){remboursementDeniseTotal+=n.Montant}),console.log("Remboursement Denise total : "+remboursementDeniseTotal)}function displayRemboursement(){var e=0,n=0;e=depenseListMerlinTotal+depenseDocLibMerlinTotal-remboursementMerlinTotal,n=depenseListDeniseTotal+depenseDocLibDeniseTotal-remboursementDeniseTotal,divImmodmmmDepense=$("#immodmmmDepense"),divRemboursementDenise=$("<div>",{"class":"Remboursement",text:"Remboursement Denise : "+n}),divImmodmmmDepense.append(divRemboursementDenise),divRemboursementMerlin=$("<div>",{"class":"Remboursement",text:"Remboursement Merlin : "+e}),divImmodmmmDepense.append(divRemboursementMerlin)}function errorHandler(e,n){console.log("Error: "+n.get_message())}function getListByTitleItems(e,n,s,t,o,i,r){"undefined"!=typeof s&&(s="?$Filter="+s),"undefined"!=typeof t&&(t="&$Select="+t),"undefined"!=typeof o&&(o="&$orderby="+o);var l=n+"/_api/web/lists/getbytitle('"+e+"')/items"+s+t+o+"&$top=5000";console.log("getListItems: restUrl="+l),$.ajax({url:l,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(e){i(e)},failure:function(e){r(e)}})}function getListByGuidItems(e,n,s,t,o,i,r){"undefined"!=typeof s&&(s="?$Filter="+s),"undefined"!=typeof t&&(t="&$Select="+t),"undefined"!=typeof o&&(o="&$orderby="+o);var l=n+"/_api/web/lists('"+e+"')/items"+s+t+o+"&$top=5000";console.log("getListItems: restUrl="+l),$.ajax({url:l,method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(e){i(e)},failure:function(e){r(e)}})}var depensesList,depensesListTotal=0,depensesDocLib,depensesDocLibTotal=0,remboursementArray,managerArray,depenseListMerlinTotal=0,depenseListDeniseTotal=0,depenseDocLibMerlinTotal=0,depenseDocLibDeniseTotal=0,remboursementTotal=0,remboursementMerlinTotal=0,remboursementDeniseTotal=0,divImmodmmmDepense,divDepensesListTotal,divDepensesDocLibTotal,divDepensesTotal,depensesTotal;$(document).ready(function(){var e=getAllDepensesList(),n=getAllDepensesDocLib(),s=getAllRemboursement();$.when(e,n,s).done(function(){getAllDepensesList(),getAllDepensesDocLib(),getAllRemboursement(),getAllManager(),calcultateDepense(),calculateRemboursement(),displayRemboursement()})});